# Isoform assignment

Objective: explore consequences of how features are located when data
is summarized at gene level.

The *macrophage* package provides Salmon quantification files for a
set of 24 RNA-seq samples from @Alasoo2018, "Shared genetic effects
on chromatin and gene expression indicate a role for enhancer priming in
immune response". Data for six female human donors is available in the
package, with gene expression at baseline, after IFN-gamma stimulation,
after exposure to *Salmonella*, and after a combination of the two
treatments.

```{r message=FALSE}
library(macrophage)
library(dplyr)
library(tximeta)
dir <- system.file("extdata", package="macrophage")
coldata <- read.csv(file.path(dir, "coldata.csv")) %>%
  mutate(files = file.path(dir, "quants", names, "quant.sf.gz"),
         condition = factor(condition_name),
         condition = relevel(condition, "naive")) %>%
  select(files, names=sample_id, condition, line_id)
se <- tximeta(coldata, dropInfReps=TRUE)
```

```{r message=FALSE}
library(SummarizedExperiment)
rowRanges(se)
seqinfo(se)
```

```{r}
gse <- summarizeToGene(se)
```
