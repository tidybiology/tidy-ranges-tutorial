# Tidy bulk RNA-seq analysis of Oct4 dataset

Objective: learn how to perform EDA of RNA-seq data using *tidybulk*.

```{r}
library(oct4)
dir <- system.file("extdata", package="oct4")
coldata <- read.csv(file.path(dir,"coldata.csv"))
coldata
coldata$files <- file.path(dir, "quants", coldata$names, "quant.sf.gz")
```

```{r eval=FALSE}
library(tximeta)
se <- tximeta(coldata)
gse <- summarizeToGene(se)
save(se, gse, file="data/oct4_obj.rda")
```

```{r}
library(SummarizedExperiment)
load("data/oct4_obj.rda")
```

```{r}
assayNames(gse)
assays(gse) <- assays(gse)[1:3]
gse$rep <- rep(1:3, 4)
colnames(gse) <- paste(gse$line,gse$condition,gse$rep,sep="-")
```

```{r}
library(tidybulk)
library(dplyr)
library(stringr)
oct4 <- gse %>%
  tidybulk() %>%
  filter(line == "OCT4") %>%
  mutate(.sample = str_remove(.sample, "OCT4-"))
```

```{r}
oct4 <- oct4 %>%
  keep_abundant(factor_of_interest = condition) %>%
  scale_abundance(method="RLE") # DESeq2 scaling
```

```{r}
library(ggplot2)
oct4 %>%
  ggplot(aes(.sample, log10(abundance + 1))) +
  geom_boxplot()
```
